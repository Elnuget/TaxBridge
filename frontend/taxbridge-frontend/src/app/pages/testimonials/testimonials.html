<!--
  Usamos el HTML simple (divs) que s铆 renderiz贸,
  pero le aplicamos las clases de dise帽o del SCSS.
-->
<div class="testimonials-section py-5">
    <div class="custom-container"> <!-- Reemplazamos <c-container> -->

        <!-- Encabezado de la Secci贸n -->
        <div class="section-header-modern text-center mb-5">
            <span class="section-badge">
                <i class="cil-star me-2"></i>
                Nuestros Clientes Opinan
            </span>
            <h2 class="section-title-modern mt-3">La Confianza de Quienes Ya Automatizan</h2>
        </div>

        <!-- Mensaje de Carga -->
        <div *ngIf="isLoading" class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Cargando...</span>
            </div>
            <p class="mt-3">Cargando testimonios...</p>
        </div>

        <!-- Mensaje de Error -->
        <div *ngIf="error && !isLoading" class="text-center py-5">
            <!-- Alert de error con informaci贸n detallada -->
            <div class="alert alert-danger" role="alert">
                <h5 class="alert-heading">
                    <i class="cil-warning me-2"></i>
                    Error al cargar testimonios
                </h5>
                <hr>
                <p class="mb-2"><strong>{{ error }}</strong></p>
                <small class="text-muted d-block mt-3">
                     Abre la consola del navegador (F12) para ver informaci贸n detallada del error
                </small>
            </div>
            
            <!-- Bot贸n para reintentar -->
            <button class="btn btn-primary mt-3" (click)="fetchTestimonials()">
                <i class="cil-reload me-2"></i>
                Reintentar Carga
            </button>
        </div>

        <!--
      No usamos <c-carousel>. Mostraremos TODAS las rese帽as en una cuadr铆cula (grid).
      Esto es m谩s simple y evita el componente que falla.
    -->
        <div *ngIf="!isLoading && !error && testimonials.length > 0" class="testimonial-grid">

            <!-- CAMBIO AQU: Se elimin贸 .slice(0, 3) para mostrar todos los testimonios -->
            <div *ngFor="let testimonial of testimonials" class="testimonial-card-wrapper">
                <div class="testimonial-card">

                    <!-- Rating (Estrellas) -->
                    <div class="rating-stars mb-3">
                        <i *ngFor="let star of getStars(testimonial.rating)" class="cil-star"></i>
                        <span *ngIf="testimonial.rating < 5">
                            <i *ngFor="let star of [].constructor(5 - testimonial.rating)" class="cil-star empty"></i>
                        </span>
                    </div>

                    <!-- La Cita (Testimonio) -->
                    <p class="testimonial-quote">"{{ testimonial.quote }}"</p>

                    <!-- Info del Usuario (Sin Foto) -->
                    <div class="user-info">
                        <div class="user-details">
                            <h5 class="user-name">{{ testimonial.name }}</h5>
                            <p class="user-role-company">{{ testimonial.role }} en {{ testimonial.company }}</p>
                            <span class="product-badge">
                                <i class="cil-check-circle me-1"></i>
                                Us贸: {{ testimonial.productUsed }}
                            </span>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- Mensaje si no hay testimonios -->
        <div *ngIf="!isLoading && !error && testimonials.length === 0" class="text-center py-5">
            <p>A煤n no hay testimonios para mostrar.</p>
        </div>

    </div>
</div>